= Работа с артефактами
:source-highlighter: highlight.js

== Цели урока

* Понять, что такое артефакты в CI/CD.
* Научиться загружать (`upload`) и скачивать (`download`) артефакты между задачами.

---

== Теория

=== Что такое артефакты?

*Артефакты* — это файлы или наборы файлов, которые создаются в процессе выполнения workflow. Это могут быть:

*   Отчеты о тестировании или анализе.
*   Собранное приложение (`.app` или `.ipa`).
*   Логи выполнения.
*   Любые другие данные, которые нужно сохранить после завершения задачи или передать в другую задачу.

Задачи (`jobs`) в GitHub Actions выполняются на чистых, изолированных виртуальных машинах. Артефакты — это основной способ обмена данными между ними.

=== Загрузка артефактов (`upload-artifact`)

Давайте модифицируем наши задачи анализа, чтобы они сохраняли сгенерированные отчеты. Для этого используется action `actions/upload-artifact`.

[source,yaml]
----
# В задаче swiftlint_analysis
- name: Upload SwiftLint artifact
  uses: actions/upload-artifact@v4
  if: always()
  with:
    name: swiftlint-report
    path: swiftlint-report.html
----

*   `if: always()`: Гарантирует, что шаг выполнится всегда, даже если предыдущий шаг (запуск анализатора) завершился с ошибкой. Это позволяет нам сохранить отчет о проваленных проверках.
*   `name: swiftlint-report`: Имя артефакта.
*   `path: swiftlint-report.html`: Путь к файлу, который нужно загрузить.

Аналогичный шаг добавляется и в задачу `clang_analysis` для сохранения `clang-analyzer-log.txt`.

=== Скачивание артефактов (`download-artifact`)

В последующих задачах мы можем получить доступ к этим файлам с помощью action `actions/download-artifact`.

В следующем уроке мы создадим задачу, которая скачает все наши отчеты и опубликует их на веб-странице.