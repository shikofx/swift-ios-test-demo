# Детальный План Работы над проектом "swift-ios-test-demo"

Этот документ описывает поэтапный план по созданию тестового фреймворка для iOS-приложения `Sauce Demo`. Цель — создать исчерпывающее портфолио, демонстрирующее навыки в UI-тестировании на iOS.

**Контекст:** Разработка ведется на основе знаний, полученных в ходе прохождения курса в отдельном проекте `ios-automation-cource-unit`. Этот план сфокусирован на применении теории для создания чистового портфолио.

**Сроки:** 08.10.2025 - 30.10.2025 (23 дня).

## Структура веток

Проект будет развиваться поэтапно. Каждый этап соответствует отдельной `feature`-ветке, которая создается из `main` и после завершения вливается обратно.

| Ветка | Описание | Ключевые технологии |
| :--- | :--- | :--- |
| `feature/*` | Ветки для разработки нового функционала (например, `feature/1-project-ci`). Создаются из `main`. | - |
| `main` | Релизная ветка, содержит стабильный код. | - |
| `feature/1-project-ci` | **Настройка базового CI:** Создание CI на GitHub Actions. | `Xcode`, `Swift`, `GitHub Actions` |
| `feature/2-basic-ui-tests` | **Первые UI-тесты:** Написание базовых тестов и реализация Page Object. | `XCUITest`, `Page Object` |
| `feature/3-snapshot-tests` | **Snapshot-тестирование:** Внедрение тестов для отслеживания визуальных регрессий. | `SnapshotTesting`, `SPM` |
| `feature/4-gitlab-ci` | **Настройка GitLab CI:** Добавление второго пайплайна для GitLab. | `GitLab CI`, `YAML` |
| `feature/5-abstractions` | **Слой абстракций:** Создание оберток для упрощения работы с UI-элементами. | `Swift`, `XCUITest` |
| `feature/6-helpers-services` | **Вспомогательные сервисы:** Реализация хелперов для работы с тестовыми данными и API. | `Swift`, `URLSession` |
| `feature/7-reporting-cloud` | **Отчетность и облака:** Интеграция с Allure Report и облачными фермами. | `Allure`, `BrowserStack` |
| `feature/8-final-refactoring` | **Финальный рефакторинг:** Улучшение кода и документации. | `Swift`, `Markdown` |

---

## Этап 1: Настройка проекта, CI и изучение основ (08.10 - 14.10)

**Цель:** Создать фундамент для проекта, настроить CI и изучить ключевые модули по XCUITest и Page Object.

* [ ] **Ветка:** `feature/1-project-ci`
* [ ] **Задачи по изучению курса (`ios-automation-cource-unit`):**

  * [ ] **Модуль "Основы Unit-тестирования":**
    * [ ] **Урок 1-4: Изучение теории.**
      * [x] Пройти уроки по основам Unit-тестов, настройке XCTest, написанию тестов (Given-When-Then) и видам ассертов.
    * [ ] **Урок 5: Выполнение домашнего задания.**

      * [ ] **Детали ДЗ:** Написать Unit-тесты для `ViewModel`, покрыв различные сценарии и используя разнообразные ассерты.
      * [ ] **Критерии зачета:** Все проверки корректны, использованы разные виды ассертов (не только `XCTAssertTrue`), CI пайплайн "зеленый".
      * [ ] **Чеклист работы над ДЗ:**
        * [ ] Сделать fork репозитория `Lesson-2-Unit-Tests`.
        * [ ] Создать ветку `Lesson-2-Unit-Tests-Homework`.
        * [ ] Написать тесты согласно требованиям.
        * [ ] Убедиться, что все тесты проходят локально.
        * [ ] Запушить изменения в свою ветку.
        * [ ] Создать Merge Request в `Lesson-2-Unit-Tests`.
        * [ ] Приложить скриншот с пройденными тестами к MR.
        * [ ] Отправить ссылки на проект и MR на проверку.
    * [ ] **Получение аппрува от ментора.**

  * [ ] **Модуль "Основы XCUITest и Page Object":**
    * [ ] Изучение теории по UI-тестам и паттерну Page Object.
    * [ ] Выполнение соответствующего домашнего задания.
    * [ ] Получение аппрува от ментора.
* [ ] **Задачи по проекту (`swift-ios-test-demo`):**
  * [ ] **Документация по статическому анализу:**
    * [ ] Создать документ `docs/analysis/static_swift_swiftlint.adoc`.
    * [ ] Создать документ `docs/analysis/static_swift_clang_analyzer.adoc`.


  * [x] **Примечание:** Начальная настройка проекта (создание, добавление исходного кода) была выполнена напрямую в ветке `main`.
  * [x] Создать новый Xcode-проект с таргетом для UI-тестов (`swift-ios-test-demo`).
  * [x] Добавить в проект исходный код приложения `my-demo-app-ios`.
  * [x] Убедиться, что приложение собирается и запускается, а пустой UI-тест выполняется успешно.
* [ ] **Задачи по CI/CD (GitHub Actions):**

  * [ ] Создать workflow `.github/workflows/ios-ci.yml`.
  * [ ] Настроить job, который запускает UI-тесты на `macos-latest` runner.
    * [ ] **Интегрировать SwiftLint:** Добавить шаг для запуска статического анализа кода. Пайплайн должен падать при наличии серьезных нарушений.
    * [ ] Создать базовый файл конфигурации `.swiftlint.yml`.
    * Использовать `xcodebuild test -scheme "swift-ios-test-demo" -destination 'platform=iOS Simulator,name=iPhone 15'`.
* [ ] **Финализация:**

  * [ ] Выполнить слияние ветки `feature/1-project-ci` в `main`.

## Этап 2: Реализация базовых UI-тестов и Page Objects (15.10 - 17.10)

**Цель:** Написать первые полноценные UI-тесты, применив знания по `XCUITest` и паттерну `Page Object`.

* [ ] **Ветка:** `feature/2-basic-ui-tests`
* [ ] **Задачи по проекту (`swift-ios-test-demo`):**

  * [ ] Создать базовый тестовый класс `BaseTest` с настройкой `XCUIApplication` в `setUpWithError`.
  * [ ] Реализовать Page Objects для экранов: `LoginScreen`, `ProductsScreen`, `CartScreen`.
  * [ ] Написать UI-тесты на авторизацию (успешную и с неверными данными).
  * [ ] Написать UI-тест на добавление товара в корзину.
* [ ] **Финализация:**

  * [ ] Выполнить слияние ветки `feature/2-basic-ui-tests` в `main`.

## Этап 3: Внедрение Snapshot-тестирования (18.10 - 20.10)

**Цель:** Добавить в проект тесты для проверки UI на визуальные регрессии.

* [ ] **Ветка:** `feature/3-snapshot-tests`
* [ ] **Задачи по изучению курса (`ios-automation-cource-unit`):**

  * [ ] **Тема: Snapshot-тестирование:**
    * [ ] Изучение теории (концепция, библиотека `SnapshotTesting`).
    * [ ] Выполнение домашнего задания.
    * [ ] Получение аппрува от ментора.
* [ ] **Задачи по проекту (`swift-ios-test-demo`):**

  * [ ] Добавить зависимость `SnapshotTesting` через Swift Package Manager.
  * [ ] Настроить базовый класс `BaseSnapshotTest` для конфигурации тестов (например, определение стратегий для разных устройств).
  * [ ] Написать snapshot-тесты для `LoginScreen` и `ProductsScreen`.
  * [ ] Записать эталонные снимки и добавить их в репозиторий.
* [ ] **Финализация:**

  * [ ] Выполнить слияние ветки `feature/3-snapshot-tests` в `main`.

## Этап 4: Настройка GitLab CI (21.10 - 22.10)

**Цель:** Добавить поддержку CI/CD в GitLab для демонстрации навыков работы с разными системами.

* [ ] **Ветка:** `feature/4-gitlab-ci`
* [ ] **Задачи по проекту (`swift-ios-test-demo`):**

  * [ ] Создать workflow `.gitlab-ci.yml`.
  * [ ] Настроить job с тегом `macos`, который запускает UI-тесты (потребуется self-hosted macOS runner).
  * [ ] Убедиться, что тесты успешно выполняются в GitLab CI.
* [ ] **Финализация:**

  * [ ] Выполнить слияние ветки `feature/4-gitlab-ci` в `main`.

## Этап 5: Создание слоя абстракций (23.10 - 25.10)

**Цель:** Упростить синтаксис тестов и повысить их читаемость, применив знания об архитектуре фреймворка.

* [ ] **Ветка:** `feature/5-abstractions`
* [ ] **Задачи по изучению курса (`ios-automation-cource-unit`):**

  * [ ] **Модуль 5 (Часть 1): Слои абстракции:**
    * [ ] Изучение теории (обертки, базовые классы/протоколы).
    * [ ] Выполнение домашнего задания.
    * [ ] Получение аппрува от ментора.
* [ ] **Задачи по проекту (`swift-ios-test-demo`):**

  * [ ] Создать `enum` `AppElement` для хранения идентификаторов всех UI-элементов.
  * [ ] Создать `protocol` `Screen` (или базовый класс), от которого будут наследоваться все Page Objects.
  * [ ] Реализовать `extension` для `XCUIElement` с методами-обертками (например, `waitAndTap()`, `clearAndTypeText()`).
  * [ ] Провести рефакторинг существующих тестов и Page Objects для использования новых абстракций.
* [ ] **Финализация:**

  * [ ] Выполнить слияние ветки `feature/5-abstractions` в `main`.

## Этап 6: Реализация хелперов и сервисов (26.10 - 27.10)

**Цель:** Создать вспомогательные инструменты для генерации тестовых данных и (опционально) взаимодействия с API.

* [ ] **Ветка:** `feature/6-helpers-services`
* [ ] **Задачи по изучению курса (`ios-automation-cource-unit`):**

  * [ ] **Модуль 5 (Часть 2): Хелперы и сервисы:**
    * [ ] Изучение теории (генерация данных, работа с API).
    * [ ] Выполнение домашнего задания.
    * [ ] Получение аппрува от ментора.
* [ ] **Задачи по проекту (`swift-ios-test-demo`):**

  * [ ] **Data Helper:** Создать генератор тестовых пользователей (валидный, заблокированный и т.д.).
  * [ ] **API Client (Опционально):** Реализовать простой API-клиент с помощью `URLSession` для сброса состояния приложения или подготовки данных перед тестом (если у `Sauce Demo` есть API).
* [ ] **Финализация:**

  * [ ] Выполнить слияние ветки `feature/6-helpers-services` в `main`.

## Этап 7: Интеграция с Allure и облачными сервисами (28.10 - 29.10)

**Цель:** Настроить генерацию наглядных отчетов и запуск тестов на реальных устройствах в облаке.

* [ ] **Ветка:** `feature/7-reporting-cloud`
* [ ] **Задачи по изучению курса (`ios-automation-cource-unit`):**

  * [ ] **Тема: Отчетность и облака:**
    * [ ] Изучение теории (Allure, облачные фермы).
    * [ ] Выполнение домашнего задания.
    * [ ] Получение аппрува от ментора.
* [ ] **Задачи по проекту (`swift-ios-test-demo`):**

  * [ ] Интегрировать Allure Report: найти или адаптировать инструмент для конвертации `.xcresult` в формат Allure.
  * [ ] **GitHub Actions:** Настроить публикацию Allure-отчета на GitHub Pages.
  * [ ] **GitLab CI:** Настроить публикацию Allure-отчета на GitLab Pages.
  * [ ] (Stretch goal) Интегрировать запуск тестов с **BrowserStack** или аналогичным сервисом.
* [ ] **Финализация:**

  * [ ] Выполнить слияние ветки `feature/7-reporting-cloud` в `main`.

## Этап 8: Финальный рефакторинг и документация (30.10)

**Цель:** Привести кодовую базу в порядок и подготовить проект к демонстрации.

* [ ] **Ветка:** `feature/8-final-refactoring`
* [ ] **Задачи по проекту (`swift-ios-test-demo`):**

  * [ ] Провести ревью всего кода, добавить комментарии, улучшить именование.
  * [ ] Написать `README.md` для проекта, описав его архитектуру, стек и как запустить тесты.
* [ ] **Финализация:**

  * [ ] Выполнить слияние ветки `feature/8-final-refactoring` в `main`. Проект готов!